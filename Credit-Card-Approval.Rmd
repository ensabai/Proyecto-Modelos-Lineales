---
title: "Predicción Tarjeta de Crédito"
author: Carlos Gila Blanco y Enrique Sayas Bailach
date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
    toc_depth: '3'
    df_print: paged
  html_notebook:
    echo: yes
    number_sections: yes
    toc: yes
  pdf_document:
    toc: yes
    toc_depth: 3
params:
  lang: ES
lang: r switch(params$lang, ES = 'es-ES', EN = 'en-US')
subtitle: Tratamiento de Datos. Grado en Ciencia de Datos- UV
language:
  label:
    fig: 'Figura '
    tab: 'Tabla '
    eq: 'Ecuación '
    thm: 'Teorema '
    lem: 'Lema '
    def: 'Definición '
    cor: 'Corolario '
    prp: 'Proposición '
    exm: 'Ejemplo '
    exr: 'Ejercicio '
    proof: 'Demostración. '
    remark: 'Nota: '
    solution: 'Solución. '
---

```{r setup, cache = F, echo = F, message = F, warning = F, tidy = F}
# Configuración del los bloques (*Chunks*)

# CONFIGURACIÓN GENERAL
library(knitr)
options(width = 100)

# Opciones generales de los chucks. Se utilizarán salvo cambios en el chunk
opts_chunk$set(echo=T, message = F, error = F, warning = F, comment = NA, fig.align = 'center', dpi = 200, tidy = F, cache.path = '.cache/', fig.path = './figura/')

# Opciones generales de dígitos cuando se incluyen tablas
#options(xtable.type = 'html')
knit_hooks$set(inline = function(x) {
  
  if(is.numeric(x)) {
    round(x, getOption('digits'))
  } else {
    paste(as.character(x), collapse = ', ')
  }
})
#knit_hooks$set(plot = knitr:::hook_plot_html)
```

```{r echo = F, message = F}
# Instalación automática de paquetes

# Especificamos las librerías necesarias en esta lista

packages = c("readr","ggplot2","dplyr","tidyr","stringr","GGally","car")

#use this function to check if each package is on the local machine
#if a package is installed, it will be loaded
#if any are not, the missing package(s) will be installed and loaded
package.check <- lapply(packages, FUN = function(x) {
  if (!require(x, character.only = TRUE)) {
    install.packages(x, dependencies = TRUE,repos='http://cran.rediris.es')
  }
  library(x, character.only = TRUE)
})

#verify they are loaded
search()
rm(list = ls())
```
# Introducción

## Contexto

Las tarjetas de calificación crediticia son un método de control de riesgos habitual en el sector financiero. Utiliza la información personal y los datos presentados por los solicitantes de tarjetas de crédito para predecir la probabilidad de futuros impagos y préstamos de tarjetas de crédito. El banco puede decidir si emite una tarjeta de crédito al solicitante. Las puntuaciones de crédito pueden cuantificar objetivamente la magnitud del riesgo.
 
En general, las tarjetas de puntuación crediticia se basan en datos históricos. Una vez que se enfrentan a grandes fluctuaciones económicas. Los modelos anteriores pueden perder su poder predictivo original. El modelo logístico es un método habitual para la puntuación crediticia ya que es adecuado para tareas de clasificación binaria y puede calcular los coeficientes de cada característica. Para facilitar la comprensión y el funcionamiento, la tarjeta de puntuación multiplicará el coeficiente de regresión logística por un valor determinado (como 100) y lo redondeará.
 
En la actualidad, con el desarrollo de los algoritmos de aprendizaje automático, se han introducido en la puntuación de tarjetas de crédito métodos más predictivos como Boosting, Random Forest y Support Vector Machines. Sin embargo, estos métodos no suelen ser muy transparentes. Puede ser difícil proporcionar a los clientes y a los reguladores una razón para el rechazo o la aceptación.

## Objetivo del Proyecto

Construir un modelo de aprendizaje automático para predecir si un candidato es un cliente "bueno" o "malo", a diferencia de otras tareas, no se da la definición de "bueno" o "malo". Deberás utilizar alguna técnica, como el análisis vintage, para construir tu etiqueta. Además, el desequilibrio de los datos es un gran problema en esta tarea.

## Descripción de los datasets

### application_record

Contiene información personal de los solicitantes del crédito.

ID: Identificador del cliente.

CODE_GENDER: Género.

FLAG_OWN_CAR: Si tiene su propio coche.

FLAG_OWN_REALITY: Si tiene una propiedad.

CNT_CHILDREN: Número de hijos.

AMT_INCOME_TOTAL: Ingresos anuales.

NAME_INCOME_TYPE: Trabajo.

NAME_EDUCATION_LABEL: Nivel educativo.

NAME_FAMILY_STATUS: Estado Civil.

NAME_HOUSING_TYPE: Tipo de vivienda.

DAYS_BIRTH: Cumpleaños, cuenta atrás desde el día actual (0), -1 significa ayer.

DAYS_EMPLOYED: Días trabajando, cuenta atrás desde el día actual. Si es positivo, quiere decir que la persona actualmente está desempleada.

FLAG_MOBILE: Si tiene un teléfono móvil.

FLAG_WORK_PHONE: Si tiene un teléfono móvil de trabajo.

FLAG_PHONE: Si tiene un teléfono fijo.

FLAG_EMAIL: Si tiene una cuenta de correo.

OCCUPATION_TYPE: Tipo de trabajo.

CNT_FAM_MEMBERS: Tamaño de la familia.

### credit_record

Registro de pagos/impagos de un cliente determinado.

ID: Identificador del cliente.

MONTHS_BALANCE: Registro por mes.

STATUS: indica el estado del crédito:
0: 1 - 29 días han pasado desde la fecha de devolución del crédito.
1: 30 - 59 días han pasado desde la fecha de devolución del crédito.
2: 60 - 89 días han pasado desde la fecha de devolución del crédito.
3: 90 - 119 días han pasado desde la fecha de devolución del crédito.
4: 120 - 149 días han pasado desde la fecha de devolución del crédito.
5: Deudas vencidas o incobrables, más de 150 días desde la fecha de devolución del crédito.
C: Se ha devuelto el crédito.
X: No hay créditos para ese mes.


# Carga de los datos

```{r}
application_record <- read_csv("data/application_record.csv")
credit_record <- read_csv("data/credit_record.csv")
```

```{r}
summary(application_record)
summary(credit_record)
```

